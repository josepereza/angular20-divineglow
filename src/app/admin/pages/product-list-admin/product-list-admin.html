<div class="container mt-4">
<br><br>
<br>

  <button class="btn btn-info mb-3" (click)="openAddModal()">
    ‚ûï Agregar Producto
  </button>

  <!-- PRODUCT LIST -->
  <div class="row">
    @for(product of products(); track product.id) {
      <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
        <div class="card bg-dark text-white shadow border-secondary h-100">

          <img [src]="product.imageUrl" class="card-img-top"
               style="height: 180px; object-fit: cover;" />

          <div class="card-body d-flex flex-column">
            <h5 class="text-info">{{ product.name }}</h5>
            <p class="text-warning small">Stock: {{ product.stock }}</p>
            <p class="small">{{ product.description }}</p>
            <p class="fw-bold text-success mt-auto">‚Ç¨ {{ product.price }}</p>

            <div class="gap-2 d-flex mt-3">
              <button class="btn btn-warning btn-sm w-50"
                      (click)="openEditModal(product)">Editar</button>
              <button class="btn btn-danger btn-sm w-50"
                      (click)="deleteProduct(product.id)">Eliminar</button>
            </div>

          </div>
        </div>
      </div>
    }
  </div>
</div>


<!-- MODAL FORM -->
<div class="modal fade show"
     tabindex="-1"
     style="display: block;"
     *ngIf="showModal()">
  <div class="modal-dialog">
    <div class="modal-content bg-dark text-white">

      <div class="modal-header">
        <h5 class="modal-title text-info">
          {{ editMode() ? '‚úèÔ∏è Editar Producto' : 'üÜï Nuevo Producto' }}
        </h5>
        <button type="button" class="btn-close btn-close-white"
                (click)="closeModal()"></button>
      </div>

      <div class="modal-body">
        <form [formGroup]="form" class="row g-3">

          <input type="hidden" formControlName="id" />

          <div class="col-12">
            <label class="form-label">Nombre</label>
            <input formControlName="name"
                   class="form-control bg-secondary text-white" />
          </div>

          <div class="col-12">
            <label class="form-label">Descripci√≥n</label>
            <textarea formControlName="description"
                      rows="2"
                      class="form-control bg-secondary text-white"></textarea>
          </div>

          <div class="col-md-6">
            <label class="form-label">Precio</label>
            <input type="number"
                   formControlName="price"
                   class="form-control bg-secondary text-white" />
          </div>

          <div class="col-md-6">
            <label class="form-label">Stock</label>
            <input type="number"
                   formControlName="stock"
                   class="form-control bg-secondary text-white" />
          </div>

          <div class="col-12">
            <label class="form-label">Imagen</label>
            <input type="file"
                   class="form-control bg-secondary text-white"
                   (change)="onFileChange($event)" />
          </div>

        </form>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">Cancelar</button>
        <button class="btn btn-info" (click)="saveProduct()">Guardar</button>
      </div>

    </div>
  </div>
</div>
